"use strict";
/*
 * @Author: he@whaleblue.design
 * @Date: 2018-03-21 16:46:54
 * @Last Modified by: Mr.He
 * @Last Modified time: 2018-07-17 22:22:28
 * @content what is the content of this file. */
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const fs = require("fs");
function loadTest(dir, callback) {
    let files = fs.readdirSync(dir);
    for (let f of files) {
        let fullPath = path.join(dir, f);
        let stat = fs.statSync(fullPath);
        if (stat.isDirectory()) {
            loadTest(fullPath, callback);
        }
        else {
            let p = fullPath.replace(/\.(ts|js)$/, "");
            let g = require(p);
            if (callback) {
                callback(g);
            }
        }
    }
}
exports.loadTest = loadTest;
function bodyParamsCheck(ctx, params) {
    let result = {};
    for (let item of params) {
        let val = ctx.request.body[item.key];
        if (!val || typeof val != "string") {
            ctx.error(500, item.msg);
            return false;
        }
        result[item.key] = val;
    }
    return result;
}
exports.bodyParamsCheck = bodyParamsCheck;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9jb21tb24vdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztnREFLZ0Q7O0FBRWhELDZCQUE4QjtBQUM5Qix5QkFBMEI7QUFFMUIsa0JBQXlCLEdBQVcsRUFBRSxRQUFtQjtJQUNyRCxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbEIsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDakMsSUFBSSxJQUFJLEdBQUcsRUFBRSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVqQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3JCLFFBQVEsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDakMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDM0MsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRW5CLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Z0JBQ1gsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hCLENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQztBQUNMLENBQUM7QUFqQkQsNEJBaUJDO0FBRUQseUJBQWdDLEdBQUcsRUFBRSxNQUFzQztJQUN2RSxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFDaEIsR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksTUFBTSxDQUFDLENBQUMsQ0FBQztRQUN0QixJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDckMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksT0FBTyxHQUFHLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNqQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDeEIsTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNqQixDQUFDO1FBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDM0IsQ0FBQztJQUVELE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDbEIsQ0FBQztBQVpELDBDQVlDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIEBBdXRob3I6IGhlQHdoYWxlYmx1ZS5kZXNpZ25cbiAqIEBEYXRlOiAyMDE4LTAzLTIxIDE2OjQ2OjU0XG4gKiBATGFzdCBNb2RpZmllZCBieTogTXIuSGVcbiAqIEBMYXN0IE1vZGlmaWVkIHRpbWU6IDIwMTgtMDctMTcgMjI6MjI6MjhcbiAqIEBjb250ZW50IHdoYXQgaXMgdGhlIGNvbnRlbnQgb2YgdGhpcyBmaWxlLiAqL1xuXG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xuaW1wb3J0IGZzID0gcmVxdWlyZShcImZzXCIpO1xuXG5leHBvcnQgZnVuY3Rpb24gbG9hZFRlc3QoZGlyOiBzdHJpbmcsIGNhbGxiYWNrPzogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICBsZXQgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhkaXIpO1xuICAgIGZvciAobGV0IGYgb2YgZmlsZXMpIHtcbiAgICAgICAgbGV0IGZ1bGxQYXRoID0gcGF0aC5qb2luKGRpciwgZik7XG4gICAgICAgIGxldCBzdGF0ID0gZnMuc3RhdFN5bmMoZnVsbFBhdGgpO1xuXG4gICAgICAgIGlmIChzdGF0LmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgICAgICAgIGxvYWRUZXN0KGZ1bGxQYXRoLCBjYWxsYmFjayk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcCA9IGZ1bGxQYXRoLnJlcGxhY2UoL1xcLih0c3xqcykkLywgXCJcIik7XG4gICAgICAgICAgICBsZXQgZyA9IHJlcXVpcmUocCk7XG5cbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYm9keVBhcmFtc0NoZWNrKGN0eCwgcGFyYW1zOiB7IGtleTogc3RyaW5nLCBtc2c6IHN0cmluZyB9W10pIHtcbiAgICBsZXQgcmVzdWx0ID0ge307XG4gICAgZm9yIChsZXQgaXRlbSBvZiBwYXJhbXMpIHtcbiAgICAgICAgbGV0IHZhbCA9IGN0eC5yZXF1ZXN0LmJvZHlbaXRlbS5rZXldO1xuICAgICAgICBpZiAoIXZhbCB8fCB0eXBlb2YgdmFsICE9IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGN0eC5lcnJvcig1MDAsIGl0ZW0ubXNnKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdFtpdGVtLmtleV0gPSB2YWw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdfQ==